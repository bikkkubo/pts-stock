# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Claude Code PROMPT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
You are an expert Google Apps Script engineer.

## ðŸŽ¯ Goal
Build a GASâ€‘only automation that:
- Every weekday 06:45Â JST
- Collects previousâ€‘day PTS top 10 gainers / losers (open, close, diff)
- Aggregates 24â€¯h news / IR sources per symbol
- Deduplicates & clusters similar articles with OpenAI embeddings
- Generates a 3â€‘sentence Japanese summary + cited URLs
- Writes rows to GoogleÂ Spreadsheet columns A:G
- Sends Slack success / error notification

The user environment:
- Development in VSÂ CodeÂ 1.96.4 + clasp
- GAS Style: Google JavaScript Style Guide
- Full, standâ€‘alone clasp project (no external build steps)
- ScriptProperties holdsÂ `QUICK_API_TOKEN`, `NIKKEI_API_KEY`, `OPENAI_API_KEY`, `SLACK_WEBHOOK`

## ðŸ“‚ Files to output
1. **Code.gs** â€“ `main()` entry, trigger installer
2. **fetchers.gs** â€“ `fetchPts(date)`, `fetchNews(code)`
3. **nlp.gs** â€“ `getEmbeddings(textArr)`, `clusterArticles(docs)`, `summarizeClusters(clusters)`
4. **writer.gs** â€“ `updateSheet(rows)`
5. **notifier.gs** â€“ `notifySlack(msg, isError)`
6. **util.gs** â€“ cosine similarity, Kâ€‘means (â‰¤â€¯50â€¯lines)
7. **.clasp.json** â€“ `"scriptId": "ENTER_YOURS"` placeholder
8. **README.md** â€“ quick start & cron setup instructions

## ðŸ“œ Coding Rules
- Provide **complete code** for every file, wrapped in triple backâ€‘ticks with filename comment.
- No ellipsis; every function must be fully runnable.
- ES5 syntax only (`var`, no async/await); GAS supports ES2023 transpile but keep it simple.
- For OpenAI calls use `UrlFetchApp.fetch` with POST JSON.
- Temperature 0.3, `gpt-4o-mini` model.
- Kâ€‘means: stop after 20Â iterations or when centroids unchanged.
- Cluster topâ€¯Kâ€¯=â€¯sqrt(n) (rounded).
- In summaries: 3Â sentences â‰¤â€¯400â€¯chars total, then `Sources:` and URL list.

## ðŸš¦ Output Format
Respond with **one message** containing sections in this exact order:

1. `### Code.gs`  
2. `### fetchers.gs`  
3. `### nlp.gs`  
4. `### writer.gs`  
5. `### notifier.gs`  
6. `### util.gs`  
7. `### .clasp.json`  
8. `### README.md`  

Each section must contain a single fenced code block (` ```javascript ` or ` ```json ` etc.) with the full contents.

Begin now.
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
