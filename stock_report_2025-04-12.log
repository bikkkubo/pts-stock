2025-04-12 20:43:33,713 - INFO - [main.py:57] - Logging initialized. Log file: stock_report_2025-04-12.log
2025-04-12 20:43:33,713 - INFO - [main.py:69] - === Starting Stock Market Analysis Report Generation for 2025-04-12 ===
2025-04-12 20:43:33,713 - INFO - [main.py:70] - Using API delay: 1.0s
2025-04-12 20:43:33,713 - INFO - [main.py:74] - Targeting root Google Drive folder.
2025-04-12 20:43:33,713 - INFO - [main.py:75] - Using Google Credentials Path: credentials.json
2025-04-12 20:43:33,713 - INFO - [main.py:90] - --- Phase 1: Scraping and Analyzing Stocks ---
2025-04-12 20:43:33,713 - INFO - [main.py:92] - Processing category: regular_up - URL: https://finance.yahoo.co.jp/stocks/ranking/up?market=all
2025-04-12 20:43:33,713 - INFO - [scraper.py:19] - Attempting to scrape URL: https://finance.yahoo.co.jp/stocks/ranking/up?market=all
2025-04-12 20:43:34,125 - WARNING - [scraper.py:127] - Finished scraping https://finance.yahoo.co.jp/stocks/ranking/up?market=all, but no valid stock data extracted from found rows.
2025-04-12 20:43:34,125 - WARNING - [main.py:96] - No stocks scraped from https://finance.yahoo.co.jp/stocks/ranking/up?market=all. Skipping analysis.
2025-04-12 20:43:34,126 - INFO - [main.py:92] - Processing category: regular_down - URL: https://finance.yahoo.co.jp/stocks/ranking/down?market=all
2025-04-12 20:43:34,126 - INFO - [scraper.py:19] - Attempting to scrape URL: https://finance.yahoo.co.jp/stocks/ranking/down?market=all
2025-04-12 20:43:34,460 - WARNING - [scraper.py:127] - Finished scraping https://finance.yahoo.co.jp/stocks/ranking/down?market=all, but no valid stock data extracted from found rows.
2025-04-12 20:43:34,460 - WARNING - [main.py:96] - No stocks scraped from https://finance.yahoo.co.jp/stocks/ranking/down?market=all. Skipping analysis.
2025-04-12 20:43:34,460 - INFO - [main.py:92] - Processing category: pts_up - URL: https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all
2025-04-12 20:43:34,460 - INFO - [scraper.py:19] - Attempting to scrape URL: https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all
2025-04-12 20:43:34,558 - ERROR - [scraper.py:137] - HTTP error occurred fetching https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all: 400 Client Error: Bad Request for url: https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all
2025-04-12 20:43:34,558 - WARNING - [main.py:96] - No stocks scraped from https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all. Skipping analysis.
2025-04-12 20:43:34,558 - INFO - [main.py:92] - Processing category: pts_down - URL: https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all
2025-04-12 20:43:34,558 - INFO - [scraper.py:19] - Attempting to scrape URL: https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all
2025-04-12 20:43:34,636 - ERROR - [scraper.py:137] - HTTP error occurred fetching https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all: 400 Client Error: Bad Request for url: https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all
2025-04-12 20:43:34,637 - WARNING - [main.py:96] - No stocks scraped from https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all. Skipping analysis.
2025-04-12 20:43:34,637 - INFO - [main.py:127] - --- Completed Scraping and Analysis Phase ---
2025-04-12 20:43:34,637 - INFO - [main.py:128] - Total stocks analyzed: 0
2025-04-12 20:43:34,637 - INFO - [main.py:129] - Total stop-high/low stocks found: 0
2025-04-12 20:43:34,637 - INFO - [main.py:132] - --- Phase 2: Generating Google Docs Report ---
2025-04-12 20:43:34,637 - INFO - [reporter.py:122] - Attempting to create Google Docs report...
2025-04-12 20:43:34,639 - ERROR - [reporter.py:189] - Failed Google Docs operation: Service account info was not in the expected format, missing fields token_uri, client_email.
Traceback (most recent call last):
  File "/Users/okb/Desktop/1_Projects/pj-youtube/pts/reporter.py", line 133, in create_google_doc
    creds = service_account.Credentials.from_service_account_file(creds_path, scopes=SCOPES)
  File "/Users/okb/.pyenv/versions/3.10.13/lib/python3.10/site-packages/google/oauth2/service_account.py", line 260, in from_service_account_file
    info, signer = _service_account_info.from_filename(
  File "/Users/okb/.pyenv/versions/3.10.13/lib/python3.10/site-packages/google/auth/_service_account_info.py", line 80, in from_filename
    return data, from_dict(data, require=require, use_rsa_signer=use_rsa_signer)
  File "/Users/okb/.pyenv/versions/3.10.13/lib/python3.10/site-packages/google/auth/_service_account_info.py", line 50, in from_dict
    raise exceptions.MalformedError(
google.auth.exceptions.MalformedError: Service account info was not in the expected format, missing fields token_uri, client_email.
2025-04-12 20:43:34,640 - ERROR - [main.py:158] - Failed to create Google Docs report. Check previous logs.
2025-04-12 20:43:34,640 - INFO - [main.py:165] - === Stock Market Analysis Report Generation Finished ==
2025-04-12 20:43:34,640 - INFO - [main.py:166] - Total execution time: 0.93 seconds
2025-04-12 23:28:33,327 - INFO - [main.py:57] - Logging initialized. Log file: stock_report_2025-04-12.log
2025-04-12 23:28:33,327 - INFO - [main.py:69] - === Starting Stock Market Analysis Report Generation for 2025-04-12 ===
2025-04-12 23:28:33,327 - INFO - [main.py:70] - Using API delay: 1.0s
2025-04-12 23:28:33,327 - INFO - [main.py:74] - Targeting root Google Drive folder.
2025-04-12 23:28:33,327 - INFO - [main.py:75] - Using Google Credentials Path: credentials.json
2025-04-12 23:28:33,327 - INFO - [main.py:90] - --- Phase 1: Scraping and Analyzing Stocks ---
2025-04-12 23:28:33,327 - INFO - [main.py:92] - Processing category: regular_up - URL: https://finance.yahoo.co.jp/stocks/ranking/up?market=all
2025-04-12 23:28:33,327 - INFO - [scraper.py:19] - Attempting to scrape URL: https://finance.yahoo.co.jp/stocks/ranking/up?market=all
2025-04-12 23:28:33,734 - WARNING - [scraper.py:127] - Finished scraping https://finance.yahoo.co.jp/stocks/ranking/up?market=all, but no valid stock data extracted from found rows.
2025-04-12 23:28:33,734 - WARNING - [main.py:96] - No stocks scraped from https://finance.yahoo.co.jp/stocks/ranking/up?market=all. Skipping analysis.
2025-04-12 23:28:33,734 - INFO - [main.py:92] - Processing category: regular_down - URL: https://finance.yahoo.co.jp/stocks/ranking/down?market=all
2025-04-12 23:28:33,734 - INFO - [scraper.py:19] - Attempting to scrape URL: https://finance.yahoo.co.jp/stocks/ranking/down?market=all
2025-04-12 23:28:34,097 - WARNING - [scraper.py:127] - Finished scraping https://finance.yahoo.co.jp/stocks/ranking/down?market=all, but no valid stock data extracted from found rows.
2025-04-12 23:28:34,098 - WARNING - [main.py:96] - No stocks scraped from https://finance.yahoo.co.jp/stocks/ranking/down?market=all. Skipping analysis.
2025-04-12 23:28:34,098 - INFO - [main.py:92] - Processing category: pts_up - URL: https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all
2025-04-12 23:28:34,098 - INFO - [scraper.py:19] - Attempting to scrape URL: https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all
2025-04-12 23:28:34,184 - ERROR - [scraper.py:137] - HTTP error occurred fetching https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all: 400 Client Error: Bad Request for url: https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all
2025-04-12 23:28:34,185 - WARNING - [main.py:96] - No stocks scraped from https://finance.yahoo.co.jp/stocks/ranking/pts_up?market=all. Skipping analysis.
2025-04-12 23:28:34,185 - INFO - [main.py:92] - Processing category: pts_down - URL: https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all
2025-04-12 23:28:34,185 - INFO - [scraper.py:19] - Attempting to scrape URL: https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all
2025-04-12 23:28:34,271 - ERROR - [scraper.py:137] - HTTP error occurred fetching https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all: 400 Client Error: Bad Request for url: https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all
2025-04-12 23:28:34,272 - WARNING - [main.py:96] - No stocks scraped from https://finance.yahoo.co.jp/stocks/ranking/pts_down?market=all. Skipping analysis.
2025-04-12 23:28:34,272 - INFO - [main.py:127] - --- Completed Scraping and Analysis Phase ---
2025-04-12 23:28:34,272 - INFO - [main.py:128] - Total stocks analyzed: 0
2025-04-12 23:28:34,272 - INFO - [main.py:129] - Total stop-high/low stocks found: 0
2025-04-12 23:28:34,272 - INFO - [main.py:132] - --- Phase 2: Generating Google Docs Report ---
2025-04-12 23:28:34,272 - INFO - [reporter.py:122] - Attempting to create Google Docs report...
2025-04-12 23:28:34,276 - INFO - [__init__.py:49] - file_cache is only supported with oauth2client<4.0.0
2025-04-12 23:28:34,278 - INFO - [__init__.py:49] - file_cache is only supported with oauth2client<4.0.0
2025-04-12 23:28:35,833 - INFO - [reporter.py:160] - Created Google Doc ID: 1GfGYtoJjui-qglAySoEg_1QlccdTzhxgY5mIWyV0Blw in root Drive
2025-04-12 23:28:36,262 - INFO - [reporter.py:173] - Document content updated for Doc ID: 1GfGYtoJjui-qglAySoEg_1QlccdTzhxgY5mIWyV0Blw
2025-04-12 23:28:36,262 - INFO - [main.py:156] - Successfully created Google Docs report: https://docs.google.com/document/d/1GfGYtoJjui-qglAySoEg_1QlccdTzhxgY5mIWyV0Blw/edit
2025-04-12 23:28:36,263 - INFO - [main.py:165] - === Stock Market Analysis Report Generation Finished ==
2025-04-12 23:28:36,263 - INFO - [main.py:166] - Total execution time: 2.94 seconds
